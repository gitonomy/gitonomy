{% extends "GitonomyWebsiteBundle:Message:message.html.twig" %}

{% trans_default_domain 'newsfeed' %}

{% block sentence %}
    {% set count = message.commitCount %}
    {% if message.isForce %}
        {{ 'message.commit_forced'|trans({'%commits%': 'inline.commits'|transchoice(count)})|replace({'%ref%': message.shortReferenceName, '%before_verb%': '<span class="message-blue">', '%after_verb%': '</span>'})|raw }}
    {% else %}
        {{ 'message.commit_pushed'|trans({'%commits%': 'inline.commits'|transchoice(count)})|replace({'%ref%': message.shortReferenceName, '%before_verb%': '<span class="message-blue">', '%after_verb%': '</span>'})|raw }}
    {% endif %}
{% endblock %}

{% block message %}
    {% set count = message.commitCount %}
    {% if count %}
        <table class="commit-list">
            <tbody>
                {% for commit in message.commits %}
                    <tr>
                        <td class="span1 message">
                            <a title="{{ commit.message }}" href="{{ path('project_commit', {'slug': message.feed.project.slug, 'hash': commit.hash }) }}">
                                {{ commit.shortHash }}
                            </a>
                        </td>
                        <td class="span10">{{ commit.shortMessage }}</td>
                        <td class="span3 author">
                            <img class="avatar" src="{{ gravatar(commit.authorEmail, 16) }}" alt="{{ commit.authorName }}" title="{{ commit.authorName }}" />
                            {{ commit.authorName }}
                        </td>
                    </tr>
                {% endfor %}
                {% if count > 3 %}
                    <tr>
                        <td colspan="2">
                            <small>{{ 'message.other_commits'|transchoice(count - 3) }}</small>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    {% endif %}
{% endblock message %}
